# BSQ Tester 詳細ドキュメント

## テストの種類と実行方法

### 1. 基本機能テスト

基本的なマップ処理の機能をテストします。

```bash
# 基本テストのみ実行
./bsq_tester.sh
```

テストケース：
- 3x3の空のマップ
- 障害物を含むマップ
- 最小サイズ（1x1）のマップ

### 2. エラー処理テスト

無効なマップに対する処理をテストします。

テストケース：
- 無効な最初の行
- 異なる行の長さ
- 無効な文字
- 空ファイル
- 最初の行の欠落
- 無効なサイズ（0や負数）

### 3. エッジケーステスト

境界条件や特殊なケースをテストします。

テストケース：
- 全て障害物のマップ
- 単一の障害物
- 境界ケース（マップの端に近い位置）

### 4. 標準入力テスト

標準入力からのマップ読み取りをテストします。

```bash
# 標準入力テストの例
echo "3.ox\n...\n...\n...\n" | ./bsq
```

テストケース：
- 基本的な入力
- 障害物のある入力
- 無効な入力

### 5. メモリリークテスト

Valgrindを使用してメモリリークをチェックします。

```bash
# メモリリークチェック付きでテスト実行
./bsq_tester.sh -m
```

チェック項目：
- メモリリーク
- 未初期化メモリの使用
- 無効なメモリアクセス
- 二重解放

### 6. パフォーマンステスト

大規模マップでの実行時間をテストします。

テストケース：
1. 中規模マップ (50x50)
   - 制限時間: 2秒以内
   - 全て空きマス
   - ランダムな障害物

2. 大規模マップ (100x100)
   - 制限時間: 5秒以内
   - 全て空きマス
   - ランダムな障害物

3. 超大規模マップ (200x200)
   - 制限時間: 10秒以内
   - 全て空きマス
   - ランダムな障害物

## 詳細なオプション

### プログラム名の指定

```bash
./bsq_tester.sh -p custom_bsq
```

- デフォルト: "bsq"
- 異なる名前でコンパイルした場合に使用

### テストディレクトリの指定

```bash
./bsq_tester.sh -d custom_tests
```

- デフォルト: "test_maps"
- 一時ファイルの保存場所を変更する場合に使用

### 詳細出力の有効化

```bash
./bsq_tester.sh -v
```

出力される情報：
- 入力データの内容
- 期待される出力
- 実際の出力
- テスト実行時間
- メモリ使用状況（-mオプション併用時）

### メモリチェックの有効化

```bash
./bsq_tester.sh -m
```

チェック内容：
- メモリリークの検出
- 未初期化メモリの使用検出
- 無効なメモリアクセスの検出
- 二重解放の検出

## カスタムテストの追加

### 1. 新しいテストケースの追加

`bsq_tester.sh`に新しいテストケースを追加する場合：

```bash
# テストケースの追加例
run_test "テスト名" "入力データ" "期待される出力"
```

### 2. カスタムマップファイルの使用

`example_maps`ディレクトリにカスタムマップを追加：

```bash
# マップファイルの作成例
echo "5.ox
.....
.o...
.....
...o.
....." > example_maps/custom_map.txt
```

## トラブルシューティング詳細

### 1. メモリリーク検出時

1. Valgrindの詳細出力を確認
2. リークの発生箇所を特定
3. 該当する箇所のメモリ管理を確認

### 2. パフォーマンス問題

1. 実行時間を確認
2. アルゴリズムの効率を検証
3. メモリ使用量を確認

### 3. 不正な出力

1. 入力データを確認
2. 期待される出力と実際の出力を比較
3. エラーメッセージを確認

## 既知の制限事項

1. Valgrindは一部の環境で正確に動作しない場合があります
2. 非常に大きなマップ（1000x1000以上）はテストされません
3. 特殊文字を含むマップは正しく処理されない可能性があります

## 更新履歴

### Version 3.0 (2024-02-24)
- 特殊ケーステストの追加
  - マップ前後の空行テスト
  - マップ中の空行テスト
  - 数字を使用したマップ文字テスト
  - 非表示文字（タブ、制御文字）テスト
  - 同じ文字を使用したマップ文字テスト
  - 最終行の改行なしテスト
- テストケース詳細セクションの追加
- ドキュメントの改善と整理

### Version 2.0 (2024-02-01)
- パフォーマンステストの追加
  - 中規模マップ (50x50)
  - 大規模マップ (100x100)
  - 超大規模マップ (200x200)
- メモリリークチェック機能の追加
- 複数ファイルテストの追加
- エラー処理の強化

### Version 1.0 (2024-01-15)
- 初期リリース
- 基本機能テスト
- エラー処理テスト
- エッジケーステスト
- 標準入力テスト 